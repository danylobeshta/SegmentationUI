# Детекція крововиливів та покращення зображень


## Опис програми

Це інтелектуальна система для детекції внутрішньочерепних крововиливів (ВЧК) на медичних зображеннях та покращення якості зображень за допомогою прогресивних математичних операторів. Програма поєднує сучасні методи глибокого навчання з теорією дробових похідних.

### Основні можливості

- **Автоматична детекція крововиливів** за допомогою нейронної мережі U-Net
- **Покращення зображень** через оператор Атангана-Беленау
- **Підвищення контрасту** за допомогою дробових похідних Рісса
- **Інтуїтивний графічний інтерфейс** з налаштуваннями в реальному часі
- **Візуалізація результатів** з порівнянням до/після обробки
- **Експорт результатів** у популярних форматах

## Вимоги системи

### Програмне забезпечення
- Python 3.7 або новіший
- CUDA-сумісна відеокарта (рекомендовано для прискорення)

### Залежності
```
torch>=1.9.0
torchvision>=0.10.0
numpy>=1.19.0
opencv-python>=4.5.0
Pillow>=8.0.0
matplotlib>=3.3.0
scipy>=1.6.0
tkinter (зазвичай входить у стандартну поставку Python)
```

## Встановлення

### 1. Клонування репозиторію
```bash
git clone https://github.com/your-username/ich-detection.git
cd ich-detection
```

### 2. Створення віртуального середовища
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# або
venv\Scripts\activate     # Windows
```

### 3. Встановлення залежностей
```bash
pip install -r requirements.txt
```

### 4. Запуск програми
```bash
python main.py
```

## Інструкція з використання

### Початок роботи

1. **Запустіть програму**: `python main.py`
2. **Завантажте зображення**: Натисніть "Завантажити зображення" та виберіть файл
3. **Завантажте модель** (опціонально): Якщо маєте навчену модель U-Net

### Основні функції

#### Детекція крововиливу
- Використовує навчену модель U-Net для сегментації
- Показує ймовірність крововиливу у відсотках
- Генерує бінарну маску з виявленими областями

**Кроки:**
1. Завантажте зображення
2. Завантажте навчену модель (.pth, .pt, .tar)
3. Натисніть "Детекція крововиливу"

#### Покращення Атангана-Беленау
Математичний оператор на основі дробового числення для підвищення контрасту.

**Параметри:**
- **Alpha (α)**: 0.1-1.0 (рекомендовано 0.5-0.9)
  - 0.3-0.5: Легке покращення
  - 0.6-0.8: Помірне покращення  
  - 0.8-1.0: Інтенсивне покращення
- **Розмір вікна**: 3-15 пікселів (рекомендовано 5-9)

#### Покращення Рісса
Дробові похідні Рісса для виявлення дрібних деталей та границь.

**Параметри:**
- **Nu (ν)**: 0.1-1.0 (рекомендовано 0.6-0.8)
- **m**: Автоматично розраховується з розміру вікна

### Рекомендовані налаштування

#### Для медичних зображень:
- **Слабке покращення**: α=0.5, вікно=5
- **Помірне покращення**: α=0.7, вікно=7  
- **Сильне покращення**: α=0.9, вікно=9

#### Для низькоконтрастних зображень:
- **Атангана-Беленау**: α=0.8-0.9, вікно=7-9
- **Рісса**: ν=0.7-0.8, m=3-4

## Технічні деталі

### Архітектура U-Net
```
Кодувальна частина:
├── Conv2D(1→64) + BatchNorm + Dropout
├── MaxPool2D + Conv2D(64→128) + BatchNorm + Dropout  
├── MaxPool2D + Conv2D(128→256) + BatchNorm + Dropout
└── MaxPool2D + Conv2D(256→256) + BatchNorm + Dropout

Декодувальна частина:
├── UpConv(512→256) + Skip Connection
├── UpConv(384→128) + Skip Connection
├── UpConv(192→64) + Skip Connection
└── Conv2D(64→1) + Sigmoid
```

### Оператор Атангана-Беленау
Використовує функцію Міттаг-Леффлера для створення ядра згортки:

```
E_α(z) = Σ(k=0 to ∞) z^k / Γ(αk + 1)
```

Де α - параметр дробового порядку, що контролює ступінь покращення.

### Дробові похідні Рісса
Реалізують дробове диференціювання через 8-напрямкові маски:

```
D^ν f(x,y) = Σ(l=0 to 7) w_l * f_l(x,y)
```

## Структура проекту

```
ich-detection/
├── main.py              # Основний файл програми
├── requirements.txt     # Залежності
├── README.md           # Документація
├── models/             # Збережені моделі
│   └── best_model.pth
├── data/               # Тестові зображення
│   └── samples/
└── results/            # Результати обробки
    └── enhanced/
```

## Інтерфейс користувача

### Основні кнопки
- **Завантажити зображення**: Підтримує PNG, JPG, JPEG, BMP, TIFF
- **Завантажити модель**: Завантаження навченої U-Net моделі
- **Скинути до оригіналу**: Повернення до початкового зображення
- **Зберегти результат**: Експорт обробленого зображення

### Панель параметрів
- **Цифрове введення**: Точне налаштування параметрів
- **Швидкі кнопки**: Готові значення для швидкого доступу
- **Передустановки**: Рекомендовані комбінації параметрів

### Область візуалізації
- **Три панелі**: Оригінал, результат, різниця
- **Синхронізоване масштабування**: Однакове відображення усіх зображень
- **Підписи**: Динамічні назви з параметрами

## Формати підтримуваних файлів

### Вхідні зображення:
- PNG (рекомендовано)
- JPEG/JPG
- BMP
- TIFF
- Градації сірого або кольорові (автоматична конвертація)

### Моделі:
- PyTorch (.pth, .pt)
- Checkpoint (.tar)

### Вихідні файли:
- PNG (без втрат)
- JPEG (з компресією)

## Обмеження та застереження

1. **Продуктивність**: Обробка великих зображень може зайняти час
2. **Пам'ять**: Для зображень високої роздільності потрібно достатньо RAM
3. **CUDA**: При відсутності GPU обчислення виконуються на CPU (повільніше)

## Поширені проблеми та рішення

### Програма не запускається
```bash
# Перевірте версію Python
python --version

# Переустановіть залежності
pip install -r requirements.txt --force-reinstall
```

### Помилка завантаження моделі
- Переконайтесь, що файл моделі не пошкоджений
- Перевірте сумісність версій PyTorch
- Спробуйте завантажити модель на CPU

### Низька якість результатів
- Перевірте якість вхідного зображення
- Спробуйте різні налаштування параметрів
- Переконайтесь, що зображення у відповідному форматі

## Плани розвитку

- [ ] Підтримка 3D зображень (DICOM)
- [ ] Додаткові методи покращення зображень
- [ ] Пакетна обробка файлів
- [ ] REST API для інтеграції
- [ ] Веб-інтерфейс
- [ ] Підтримка інших архітектур нейронних мереж
